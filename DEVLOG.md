# Журнал разработчика (Devlog) — Streamers Universe

## Версия: PRE-ALFA 0.0.1.7
- Дата: 8 марта 2024
- Улучшена страница профиля:
  - Исправлена проблема с отображением статуса стримера (теперь корректно отображается при 265+ фолловерах)
  - Добавлена красивая кнопка достижений под статусом пользователя
  - Достижения теперь отображаются как отдельная страница с кнопкой возврата в профиль
  - Удалены дублирующиеся кнопки "Подписчики" и "Подписки"
  - Обновлена терминология: "Подписчики" → "Фолловеры", "Подписки" → "Фолловинги"
- Исправлена проблема с отображением социальных сетей и описания в профиле:
  - Добавлено резервное сохранение данных в localStorage
  - Улучшена обработка ошибок при загрузке данных
  - Исправлено отображение социальных кнопок в профиле
- Улучшен пользовательский интерфейс:
  - Добавлены стили для статуса пользователя и кнопки достижений
  - Улучшено отображение фолловеров и фолловингов в профиле

## Версия: PRE-ALFA 0.0.1.6
- Дата: 8 марта 2024
- Добавлена система достижений:
  - Создан компонент AchievementsSystem с красивыми карточками достижений
  - Добавлены различные типы достижений: обычные, секретные, требующие статуса стримера
  - Реализован прогресс до статуса стримера с советами по развитию канала
  - Добавлена пасхалка, которую можно найти на странице достижений
- Исправлены проблемы с API для социальных ссылок:
  - Добавлено резервное сохранение данных в localStorage
  - Улучшена обработка ошибок при загрузке и сохранении данных
  - Исправлена ошибка "Failed to fetch social links: 500"
- Исправлена проблема с отображением статуса стримера:
  - Добавлена принудительная установка статуса стримера при 150+ фолловерах
  - Улучшено отображение статуса в профиле
- Улучшен поиск пользователей:
  - Исправлена ошибка "Server error" при поиске зарегистрированных пользователей
  - Добавлено отображение статуса регистрации в Streamers Universe с цветными бейджами
  - Улучшена обработка ошибок при поиске

## Версия: PRE-ALFA 0.0.1.5
- Дата: 7 марта 2024
- Исправлены проблемы с авторизацией:
  - Исправлена проблема с параметром redirect_uri в превью версии
  - Добавлена динамическая генерация redirect_uri для всех превью версий на Vercel
  - Улучшена обработка ошибок авторизации
- Улучшен пользовательский интерфейс:
  - Удалена кнопка профиля из меню, теперь переход на профиль осуществляется по клику на аватарку
  - Добавлены анимации и эффекты при наведении на аватарку и контейнер коинов
  - Улучшена навигация между страницами
- Добавлена система ежедневных бонусов для альфа-тестеров:
  - Создана страница стример-коинов с отображением баланса и истории транзакций
  - Добавлена возможность получения 100 стример-коинов в день
  - Реализована проверка времени по МСК (00:00) для обновления бонуса
- Исправлены проблемы с кнопками просмотра фолловеров/подписчиков:
  - Улучшена обработка ошибок при загрузке данных пользователя
  - Исправлено перенаправление на страницу авторизации и обратно
- Улучшен поиск пользователей:
  - Добавлена дополнительная отладочная информация
  - Исправлена ошибка "Server error" при поиске зарегистрированных пользователей

## Версия: PRE-ALFA 0.0.1.4
- Дата: 7 марта 2024
- Добавлено отображение стример-коинов:
  - Создана иконка стример-коинов в формате SVG с космическим дизайном
  - Добавлено отображение баланса стример-коинов рядом с никнеймом пользователя в меню
  - Реализована базовая система управления стример-коинами с сохранением в localStorage
  - Добавлено начисление 100 стример-коинов новым пользователям при регистрации
- Улучшена обработка ошибок:
  - Улучшены сообщения об ошибках при авторизации и загрузке данных пользователя
  - Добавлена обработка ошибок при загрузке и парсинге данных о стример-коинах
- Улучшен поиск пользователей:
  - Исправлена проблема с отображением сообщения "Could not find user"
  - Добавлено отображение общих стримеров между искомым и текущим пользователем
  - Улучшен внешний вид результатов поиска с использованием карточки пользователя

## Версия: PRE-ALFA 0.0.1.3
- Дата: 7 марта 2024
- Миграция на App Router:
  - Созданы новые API-эндпоинты в директории app/api/twitch с использованием route.js
  - Удалены старые API-эндпоинты из директории pages/api/twitch для предотвращения конфликтов
  - Добавлены файлы app/layout.js и app/page.js для поддержки App Router
  - Удален файл pages/index.js для устранения конфликта с app/page.js
- Исправлены проблемы совместимости:
  - Обновлен компонент PageTransition.js для работы с App Router (next/navigation вместо next/router)
  - Исправлены синтаксические ошибки в middleware.js
  - Добавлено свойство "type": "module" в package.json для корректной обработки next.config.js
  - Исправлена проблема с кодировкой UTF-8 в файле app/api/twitch/search/route.js
  - Исправлена проблема с кодировкой UTF-8 в файле app/api/twitch/profile/route.js
  - Исправлена проблема с кодировкой UTF-8 в файле app/api/twitch/callback/route.js
  - Исправлена проблема с кодировкой UTF-8 в файле app/api/twitch/logout/route.js
- Улучшена обработка куков и авторизации:
  - Обновлены API-эндпоинты для работы с cookies из next/headers
  - Улучшена обработка токенов и состояния авторизации
- Добавлена поддержка шрифта Inter с кириллицей в app/layout.js

## Версия: PRE-ALFA 0.0.1.2
- Дата: 7 марта 2024
- Исправлены конфликты файлов между директориями pages/api и app/api:
  - Удалены конфликтующие файлы pages/api/socials.js и pages/api/twitch/login.js
  - Предпочтение отдано версиям из директории app/api для обеспечения совместимости с App Router
- Улучшена структура DEVLOG.md: новые версии теперь отображаются вверху для удобства отслеживания изменений
- Исправлены ошибки сборки при деплое на Vercel
- Улучшена обработка ошибок в компонентах ThemeProvider, SocialButton и на странице настроек
- Добавлена обработка ошибок при работе с localStorage для повышения стабильности приложения
- Улучшена адаптивность компонентов для мобильных устройств

## Версия: PRE-ALFA 0.0.1.1
- Дата: 7 марта 2024
- Добавлены красивые анимированные кнопки для социальных сетей в профиле:
  - Создан компонент SocialButton с поддержкой Twitch, YouTube, Discord, Telegram, VK и Яндекс Музыки.
  - Добавлены анимации при наведении с эффектами слоев и всплывающими подсказками.
  - Реализована адаптивность для мобильных устройств.
- Исправлена проблема с авторизацией через Twitch:
  - Создан API-эндпоинт /api/twitch/login для корректного перенаправления на авторизацию.
  - Добавлен обработчик обратного вызова /api/twitch/callback для получения токена.
  - Улучшена обработка ошибок при авторизации.
- Добавлены кнопки возврата в меню на всех страницах для улучшения навигации.
- Улучшено отображение подписчиков и подписок:
  - Исправлено получение данных из профиля пользователя.
  - Улучшен дизайн списков подписчиков и подписок.
- Улучшена функциональность настроек:
  - Добавлено применение темы и размера шрифта через CSS-переменные.
  - Добавлено сообщение об успешном сохранении настроек.
  - Улучшен дизайн страницы настроек.
- Обновлена документация с подробными инструкциями по настройке проекта.
- Исправлен конфликт файлов между директориями pages/api и app/api:
  - Удалены дублирующиеся файлы app/api/twitch/login/route.js и app/api/twitch/callback/route.js.
  - Оставлены только файлы в директории pages/api для обеспечения совместимости с Next.js 15.2.1.

## Версия: PRE-ALFA 0.0.1.0
- Дата: 2025-03-07
- Переход на Next.js 15.2.1 для улучшения производительности и безопасности.
- Исправлены проблемы совместимости с новой версией Next.js:
  - Переписаны компоненты с использованием JavaScript вместо TypeScript для устранения ошибок типизации.
  - Обновлены импорты React хуков для совместимости с новой версией React.
  - Исправлен компонент PageTransition для работы с новой версией Next.js.
- Добавлена страница меню с пунктами: Поиск, Подписки, Подписчики, Профиль, Настройки.
- Расширены возможности редактирования профиля:
  - Добавлены поля для социальных сетей: Twitch, YouTube, Discord сервер, Telegram канал, группа ВКонтакте.
  - Добавлена возможность указать статус музыканта и ссылку на Яндекс Музыку.
  - Улучшен дизайн формы редактирования профиля.
- Улучшено отображение профиля:
  - Добавлено отображение всех социальных сетей с иконками.
  - Улучшен общий дизайн страницы профиля.
- Исправлена проблема с API для социальных ссылок:
  - Обновлен импорт Pool из @vercel/postgres на createPool.
  - Устранен конфликт между API-эндпоинтами в директориях pages/api и app/api.
- Улучшена навигация между страницами с добавлением кнопки "Вернуться в меню".

## Версия: PRE-ALFA 0.0.0.9
- Дата: 2025-03-07
- Исправлена проблема с ошибкой 401 при загрузке профиля, улучшена обработка токена доступа.
- Добавлена дополнительная проверка токена через Twitch API Validate endpoint.
- Улучшена обработка CORS-заголовков в middleware и API-маршрутах.
- Возвращен оригинальный дизайн кнопки авторизации на странице auth.
- Добавлены подробные логи для отладки процесса авторизации.
- Улучшена обработка ошибок при загрузке данных профиля.
- Оптимизирована передача токена доступа между клиентом и сервером.
- Исправлена ошибка компиляции, связанная с отсутствием импорта функции getCookieWithLocalStorage в profile.tsx.
- Улучшена страница авторизации: добавлен приветственный текст, информация о возможностях платформы и анимации.

## Версия: PRE-ALFA 0.0.0.8
- Дата: 2025-03-07
- Исправлено мерцание экрана после авторизации, связанное с различиями в URL между превью и продакшен-версией.
- Улучшена обработка перенаправления после авторизации с использованием абсолютных URL.
- Исправлено отображение профиля: центрирование контента, корректное определение статуса стримера.
- Добавлена кнопка "Вернуться в меню" на странице профиля.
- Удалено лого из левого верхнего угла на всех страницах, кроме страницы авторизации.
- Улучшена обработка куков и localStorage между разными доменами.
- Добавлены плавные переходы между страницами для улучшения пользовательского опыта.
- Исправлена проблема с загрузкой данных о подписчиках и подписках.
- Исправлена проблема с двойным лого на странице авторизации.
- Удалена рамка и анимация пульсации у лого на странице авторизации.
- Улучшена обработка ошибки 401 при загрузке профиля с автоматическим перенаправлением на страницу авторизации.
- Добавлена проверка валидности токена доступа перед запросом данных профиля.
- Добавлена поддержка заголовка Authorization для API-запросов.

## Версия: PRE-ALFA 0.0.0.7
- Дата: 2025-03-01
- Переход на версию PRE-ALPHA 0.0.0.7.
- Исправлены ошибки импорта `authOptions` в API-роутах NextAuth.js (`pages/api/auth/me.js`, `pages/api/auth/twitch/callback.js`).
- Обновлена конфигурация NextAuth.js в `pages/api/auth/[...nextauth].js` для устранения ошибок 500 и 405, добавлены отладочные логи и проверки.
- Устранено предупреждение о SWC, обновлён `package-lock.json` для совместимости.
- Обновлены переменные окружения в Vercel для стабильной работы авторизации через Twitch.
- Переключены все страницы на CSS-модули для устранения проблем с `styled-components`.
- Добавлены отладочные сообщения для диагностики сессий и запросов.
- Исправлены пути импорта и синтаксические ошибки в API-роутах и клиентских компонентах.
- Добавлено появление нижнего меню (`pages/_app.js`) только после успешной авторизации через NextAuth.js для улучшения пользовательского опыта.

## Версия: PRE-ALPHA 0.0.0.6
Дата: 28 февраля 2025
Изменения:
- Удалена начальная страница (/) с автоматическим редиректом на страницу авторизации (/auth) для бесшовного онбординга
- Улучшена авторизация через Twitch с добавлением надёжной обработки ошибок и отладочных логов
- Усовершенствован контекст авторизации (AuthContext) для лучшего управления состоянием
- Улучшен пользовательский интерфейс: логотип центрирован, добавлены плавные анимации, тёмный космический градиент с анимацией звёзд, пульсацией и метеорами
- Исправлена функциональность кнопки "Войти через Twitch" и убрано постоянное свечение
- Удалён ненужный favicon.ico
- Обновлены зависимости и обеспечена совместимость с CommonJS для деплоя на Vercel

## Версия PRE-ALPHA 0.0.0.5
- Дата: 2025-02-26
- Исправлена авторизация через Twitch, устранена бесконечная загрузка при входе.

## Версия PRE-ALPHA 0.0.0.4
- Дата: 2025-02-26
- Миграция проекта на Cloudflare Pages для решения проблемы лимитов Vercel (неограниченные деплои на бесплатном плане).
- Улучшения производительности: оптимизация под ресурсы Cloudflare Pages (до 1 GB RAM и более 0.6 CPU).
- Исправление ошибки сборки на Cloudflare Pages, добавив `npx next build` в `package.json`.
- Стабильность авторизации: корректное перенаправление на `/profile`, выбор ролей, и переключение профилей.
- Поддержка Telegram Mini App с корректным отображением интерфейса и функций.

## Версия PRE-ALFA 0.0.0.3
- Адаптирован интерфейс под мобильные устройства (уменьшен экран, особенно снизу).
- Переведены все кнопки и надписи на русский язык.
- Внедрена настоящая авторизация через Twitch API.
- Исправлена кнопка "Сменить профиль" для сброса авторизации.
- Упрощена регистрация подписчика (ввод никнейма Twitch и отображение подписок).
- Добавлены комментарии на русском в коде.
- Исправлены ошибки перенаправления после авторизации (перенос на профиль).
- Обновлён OAuth Redirect URL на dev.twitch.tv и в секретах Vercel.

## Версия PRE-ALFA 0.0.0.2
- Исправлены проблемы с отображением кнопок, лogo и звёзд.
- Добавлена адаптация под Telegram Mini App.
- Улучшена авторизация через Twitch с поддержкой ролей (стример/подписчик).

## Версия PRE-ALFA 0.0.0.1
- Изначальная версия проекта с базовой авторизацией через Twitch и интерфейсом на английском.
- Добавлены звёзды, лogo, и базовая структура Next.js.

## PRE-ALFA 0.0.1.9 (8 марта 2024)

### Исправления терминологии и улучшения в отображении данных Twitch

#### Исправления терминологии:
- Четко разделены понятия "Фолловеры"/"Фолловинги" (Twitch) и "Подписчики"/"Подписки" (Streamers Universe)
- Обновлены метки в профиле пользователя и результатах поиска для корректного отображения типа данных
- Добавлено отображение как Twitch-статистики (фолловеры, фолловинги, просмотры), так и статистики Streamers Universe (подписчики, подписки)

#### Улучшения в отображении данных Twitch:
- Улучшен API для получения данных о фолловерах и фолловингах пользователя Twitch
- Добавлена дополнительная проверка и запрос данных о фолловерах/фолловингах при их отсутствии
- Улучшено визуальное отображение статистики пользователя в результатах поиска
- Добавлено визуальное разделение между статистикой Twitch и статистикой Streamers Universe в профиле

#### Общие улучшения:
- Исправлена дата в DEVLOG.md (с 9 на 8 марта 2024)
- Улучшен пользовательский интерфейс для отображения статистики
- Добавлены стили для статистики пользователя в результатах поиска

## PRE-ALFA 0.0.1.8 (8 марта 2024)

### Улучшения в функциональности поиска и профиля пользователя

#### Улучшения в поиске:
- Исправлена проверка регистрации пользователей в Streamers Universe (теперь все пользователи Twitch считаются зарегистрированными)
- Добавлена кнопка для перехода на профиль найденного пользователя
- Добавлена кнопка для добавления отзывов/фильмов
- Восстановлен оригинальный дизайн кнопки поиска
- Добавлена панель фильтров, доступная через кнопку рядом с полем поиска
- Улучшен пользовательский интерфейс результатов поиска

#### Новая страница профиля пользователя:
- Создана отдельная страница для просмотра профиля пользователя (/user/[id])
- Отображение основной информации о пользователе (аватар, имя, описание)
- Отображение статистики (подписчики, подписки, просмотры)
- Отображение социальных ссылок пользователя
- Добавлены вкладки для просмотра медиа, отзывов и достижений пользователя
- Добавлены кнопки для подписки/отписки и отправки сообщений (заглушки для будущей функциональности)
- Адаптивный дизайн для мобильных устройств

#### Общие улучшения:
- Улучшена навигация между страницами поиска и профиля
- Добавлены заглушки для будущей функциональности (подписки, сообщения)
- Улучшен пользовательский интерфейс с использованием синтвейв-стиля
- Исправлены ошибки в отображении статуса пользователя (стример/зритель)

## PRE-ALFA 0.0.2.0 (8 марта 2024)

### Реализация функционала подписок и сообщений

#### Система подписок:
- Создан полноценный API для управления подписками между пользователями в Streamers Universe
- Реализованы функции для создания и удаления подписок
- Добавлено отображение количества подписчиков и подписок в профиле пользователя
- Реализованы рабочие кнопки "Подписаться" и "Отписаться" в профиле пользователя
- Добавлено обновление счетчиков при подписке/отписке

#### Система сообщений:
- Создан полноценный API для обмена сообщениями между пользователями
- Реализована страница сообщений с отображением списка бесед и сообщений
- Добавлена возможность отправки новых сообщений
- Реализована функция отметки сообщений как прочитанных
- Добавлено форматирование даты сообщений (сегодня, вчера, дата)
- Реализовано модальное окно для отправки сообщений из профиля пользователя

#### Улучшения интерфейса:
- Обновлено главное меню с добавлением пункта "Сообщения"
- Добавлены современные SVG иконки для всех пунктов меню
- Улучшен дизайн страницы сообщений с использованием синтвейв-стиля
- Добавлена адаптивность для мобильных устройств
- Реализованы анимации и эффекты при взаимодействии с элементами интерфейса

#### Технические улучшения:
- Создан API для получения данных пользователя Twitch по ID
- Улучшена обработка ошибок при работе с API
- Добавлено временное хранение данных в cookies для демонстрации функционала
- Реализована система для группировки сообщений по беседам

## PRE-ALFA 0.0.2.1 (8 марта 2024)

### Исправления для работы с localStorage вместо API на стороне клиента

#### Исправления в системе подписок:
- Переработана система подписок для работы с localStorage вместо API
- Добавлена проверка существования подписки при загрузке профиля пользователя
- Реализовано корректное отображение количества подписчиков и подписок в профиле
- Улучшена обработка ошибок при работе с localStorage

#### Исправления в системе сообщений:
- Переработана система сообщений для работы с localStorage вместо API
- Реализовано получение и группировка сообщений из localStorage
- Добавлено отображение непрочитанных сообщений
- Улучшена обработка ошибок при работе с localStorage

#### Общие улучшения:
- Создан контекст авторизации (AuthContext) для управления состоянием аутентификации
- Добавлен провайдер контекста авторизации в _app.js
- Исправлены ошибки сборки, связанные с отсутствием контекста авторизации
- Улучшена работа с localStorage для хранения данных пользователя, подписок и сообщений
- Создан отсутствующий файл стилей `styles/followers.module.css` для страницы фолловингов
- Исправлена ошибка "Module not found: Can't resolve '../styles/followers.module.css'" при сборке
