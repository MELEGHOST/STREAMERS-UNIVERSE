# Журнал разработчика (Devlog) — Streamers Universe

## Версия PRE-ALFA 0.0.0.1
- Изначальная версия проекта с базовой авторизацией через Twitch и интерфейсом на английском.
- Добавлены звёзды, лogo, и базовая структура Next.js.

## Версия PRE-ALFA 0.0.0.2
- Исправлены проблемы с отображением кнопок, лogo и звёзд.
- Добавлена адаптация под Telegram Mini App.
- Улучшена авторизация через Twitch с поддержкой ролей (стример/подписчик).

## Версия PRE-ALFA 0.0.0.3
- Адаптирован интерфейс под мобильные устройства (уменьшен экран, особенно снизу).
- Переведены все кнопки и надписи на русский язык.
- Внедрена настоящая авторизация через Twitch API.
- Исправлена кнопка "Сменить профиль" для сброса авторизации.
- Упрощена регистрация подписчика (ввод никнейма Twitch и отображение подписок).
- Добавлены комментарии на русском в коде.
- Исправлены ошибки перенаправления после авторизации (перенос на профиль).
- Обновлён OAuth Redirect URL на dev.twitch.tv и в секретах Vercel.

## Версия PRE-ALPHA 0.0.0.4
- Дата: 2025-02-26
- Миграция проекта на Cloudflare Pages для решения проблемы лимитов Vercel (неограниченные деплои на бесплатном плане).
- Улучшения производительности: оптимизация под ресурсы Cloudflare Pages (до 1 GB RAM и более 0.6 CPU).
- Исправление ошибки сборки на Cloudflare Pages, добавив `npx next build` в `package.json`.
- Стабильность авторизации: корректное перенаправление на `/profile`, выбор ролей, и переключение профилей.
- Поддержка Telegram Mini App с корректным отображением интерфейса и функций.

## Версия PRE-ALPHA 0.0.0.5
- Дата: 2025-02-26
- Исправлена авторизация через Twitch, устранена бесконечная загрузка при входе.

## Версия: PRE-ALPHA 0.0.0.6
Дата: 28 февраля 2025
Изменения:
- Удалена начальная страница (/) с автоматическим редиректом на страницу авторизации (/auth) для бесшовного онбординга
- Улучшена авторизация через Twitch с добавлением надёжной обработки ошибок и отладочных логов
- Усовершенствован контекст авторизации (AuthContext) для лучшего управления состоянием
- Улучшен пользовательский интерфейс: логотип центрирован, добавлены плавные анимации, тёмный космический градиент с анимацией звёзд, пульсацией и метеорами
- Исправлена функциональность кнопки "Войти через Twitch" и убрано постоянное свечение
- Удалён ненужный favicon.ico
- Обновлены зависимости и обеспечена совместимость с CommonJS для деплоя на Vercel

## Версия: PRE-ALPHA 0.0.0.7
- Дата: 2025-03-01
- Переход на версию PRE-ALPHA 0.0.0.7.
- Исправлены ошибки импорта `authOptions` в API-роутах NextAuth.js (`pages/api/auth/me.js`, `pages/api/auth/twitch/callback.js`).
- Обновлена конфигурация NextAuth.js в `pages/api/auth/[...nextauth].js` для устранения ошибок 500 и 405, добавлены отладочные логи и проверки.
- Устранено предупреждение о SWC, обновлён `package-lock.json` для совместимости.
- Обновлены переменные окружения в Vercel для стабильной работы авторизации через Twitch.
- Переключены все страницы на CSS-модули для устранения проблем с `styled-components`.
- Добавлены отладочные сообщения для диагностики сессий и запросов.
- Исправлены пути импорта и синтаксические ошибки в API-роутах и клиентских компонентах.
- Добавлено появление нижнего меню (`pages/_app.js`) только после успешной авторизации через NextAuth.js для улучшения пользовательского опыта.

## Версия: PRE-ALFA 0.0.0.8
- Дата: 2025-03-07
- Исправлено мерцание экрана после авторизации, связанное с различиями в URL между превью и продакшен-версией.
- Улучшена обработка перенаправления после авторизации с использованием абсолютных URL.
- Исправлено отображение профиля: центрирование контента, корректное определение статуса стримера.
- Добавлена кнопка "Вернуться в меню" на странице профиля.
- Удалено лого из левого верхнего угла на всех страницах, кроме страницы авторизации.
- Улучшена обработка куков и localStorage между разными доменами.
- Добавлены плавные переходы между страницами для улучшения пользовательского опыта.
- Исправлена проблема с загрузкой данных о подписчиках и подписках.
- Исправлена проблема с двойным лого на странице авторизации.
- Удалена рамка и анимация пульсации у лого на странице авторизации.
- Улучшена обработка ошибки 401 при загрузке профиля с автоматическим перенаправлением на страницу авторизации.
- Добавлена проверка валидности токена доступа перед запросом данных профиля.
- Добавлена поддержка заголовка Authorization для API-запросов.

## Версия: PRE-ALFA 0.0.0.9
- Дата: 2025-03-07
- Исправлена проблема с ошибкой 401 при загрузке профиля, улучшена обработка токена доступа.
- Добавлена дополнительная проверка токена через Twitch API Validate endpoint.
- Улучшена обработка CORS-заголовков в middleware и API-маршрутах.
- Возвращен оригинальный дизайн кнопки авторизации на странице auth.
- Добавлено подробное логирование для отладки процесса авторизации.
- Улучшена обработка ошибок при загрузке данных профиля.
- Оптимизирована передача токена доступа между клиентом и сервером.
- Исправлена ошибка компиляции, связанная с отсутствием импорта функции getCookieWithLocalStorage в profile.tsx.
- Улучшена страница авторизации: добавлен приветственный текст, информация о возможностях платформы и анимации.

## Версия: PRE-ALFA 0.0.1.0
- Дата: 2025-03-07
- Переход на Next.js 15.2.1 для улучшения производительности и безопасности.
- Исправлены проблемы совместимости с новой версией Next.js:
  - Переписаны компоненты с использованием JavaScript вместо TypeScript для устранения ошибок типизации.
  - Обновлены импорты React хуков для совместимости с новой версией React.
  - Исправлен компонент PageTransition для работы с новой версией Next.js.
- Добавлена страница меню с пунктами: Поиск, Подписки, Подписчики, Профиль, Настройки.
- Расширены возможности редактирования профиля:
  - Добавлены поля для социальных сетей: Twitch, YouTube, Discord сервер, Telegram канал, группа ВКонтакте.
  - Добавлена возможность указать статус музыканта и ссылку на Яндекс Музыку.
  - Улучшен дизайн формы редактирования профиля.
- Улучшено отображение профиля:
  - Добавлено отображение всех социальных сетей с иконками.
  - Улучшен общий дизайн страницы профиля.
- Исправлена проблема с API для социальных ссылок:
  - Обновлен импорт Pool из @vercel/postgres на createPool.
  - Устранен конфликт между API-эндпоинтами в директориях pages/api и app/api.
- Улучшена навигация между страницами с добавлением кнопки "Вернуться в меню".
